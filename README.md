# Personal Travel Agent Application Overview
The Watson Personal Travel Agent application integrates Watson Personality Insights services with the Watson Dialog Service.  Integration is implemented within the Orchestrator component.  Personalization of dialog is achieved in two ways: (1) personalized recommendations, and (2) tone-adapted cogntive agent responses.  The former is achieved by the Orchestrator using the Watson Personality Service to retrieve the user's personality profile and the Personalized Recommendation component which takes as input the personality profile.  The latter is achieved by passing the a user's conversation turn through the Tone Expression component to determine the emotional tone;  the tone and the the Dialog Service's response to the user's conversation turn are passed into the Tone Expression component to appropriately adapt the response to the user's tone, providing a more humanized response.  The goal of this web application is to provide an example of how the Watson Personality Insights services can be integrated into a personalized cognitive conversational solution for the travel industry. The application currently allows users to converse with Watson for an initial intent of having lost their luggage.  The Watson Personal Travel Agent suggests possible remedies - find a clothing store to replace the misplaced clothing.  Additional intents may be added at a later point in time.

#### Architecture (as of April 12, 2016)

<p>
<b>Detailed Integration of Watson Dialog with Personalization Services</b>

(Tone Detection Service, Tone Expression Service, and Personalized Recommendation Service)
</p>
<p align="center">
  <img src="/Users/april/git/personal-travel-agent/SequenceDiagram1.png" width="500"/>
</p>


#### Building the App (maven)
Switch to the navigator view in Eclipse, right-click the `pom.xml`, and select `Run As -> Maven Install` with the goals-> `clean install -Dmaven.test.skip=true -U` to skip integration tests and use the most updated plugins.

During the installation, the following tasks are done:
* The JS code is compiled. That is, the various Angular JS files are aggregated, uglified, and compressed. Various other preprocessing is performed on the web code, and the output is copied to the `<projectName>/src/main/webapp/dist` folder in the project.
* The Java code is compiled, and JUnit tests are executed against the Java code. The compiled Java and JavaScript code and various other artifacts that are required by the web project are copied to a temporary location, and a `.war` file is created.
* The Maven installation instantiates a new Websphere Liberty Profile server, deploys the `.war` file to the server, starts the server, and runs a battery of integration tests against the deployed web application.

### Deploying the App in Bluemix
Deploy the WAR file that you built in the previous section by using Cloud Foundry commands.
1. Navigate to the directory that contains the WAR file you that you generated by running the following command in the terminal: 
    ``cd <projectName>/target``
2. Connect to Bluemix by running the following command: 
    ``cf api https://api.ng.bluemix.net``
3. Log in to Bluemix by running the following command: 
    ``cf login -u <yourUsername> -o <yourOrg> -s <yourSpace>``
4. Deploy the app to Bluemix by running the following command: 
    ``cf push <yourAppName> -p <warName>.war``

### Deploying a (new) dialog file to BLuemix
TBA
Update DIALOG_ID variable with the id for the newly uploaded dialog file in 3 locations
* server.env files (Liberty Server)
* ``<projectName>/src/it/resources/server.env`` 
* Bluemix User-Defined Environment Variables

